// !!!!! This file should be autogenerated by a tool. For now it is maintained by hand.

#pragma once

#include <string>
#include <tinyxml2.h>

// TODO this block of includes would be autogenerated based on project file
#include "..\TestScene\FooComponent.h"
#include "..\TestScene\SpinningComponent.h"

using std::string;
using namespace tinyxml2;

class GameComponent;

// TODO unsure yet if this design is terrible or not
// How to avoid regenerating entire file every time a single component changes? Ugh.

GameComponent* CreateComponentByGUID(int guid)
{
    switch (guid)
    {
        case 4001:  return new SpinningComponent();
        case 4002:  return new FooComponent();
    }
    return NULL;
}

void SetParameter_GUID_4001(SpinningComponent* comp, XMLElement* param)
{
    if (param == NULL)
        return;

    // TODO generate numeric codes for each parameter, to avoid string compare?
    const char* name = param->Attribute("name");
    if (strcmp(name, "Speed") == 0)
    {
        comp->Speed = param->FloatAttribute("value");
    }
    else if (strcmp(name, "Label") == 0)
    {
        comp->Label = param->Attribute("value");
    }
    else if (strcmp(name, "EnableSpinning") == 0)
    {
        comp->EnableSpinning = param->BoolAttribute("value");
    }
}

void SetParameter_GUID_4002(FooComponent* comp, XMLElement* param)
{
    if (param == NULL)
        return;

    // TODO generate numeric codes for each parameter, to avoid string compare?
    const char* name = param->Attribute("name");
    if (strcmp(name, "BarParam") == 0)
    {
        comp->BarParam = param->FloatAttribute("value");
    }
    else if (strcmp(name, "BazParam") == 0)
    {
        comp->BazParam = param->BoolAttribute("value");
    }
}

void SetComponentParameter(int guid, GameComponent* comp, XMLElement* param)
{
    // TODO make this a hash map of function pointers instead of a giant switch statement?

    switch (guid)
    {
        case 4001:  // SpinningComponent
        {
            SetParameter_GUID_4001((SpinningComponent*)comp, param);
            break;
        }
        case 4002:  // FooComponent
        {
            SetParameter_GUID_4002((FooComponent*)comp, param);
            break;
        }
        default:
        {
            printf("Error: missing guid in generated bindings file: %d\n", guid);
            break;
        }
    }
}
